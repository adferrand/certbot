# Certbot for Window (beta)

The Certbot development team is proud to propose you the first beta release of Certbot for Windows.

This document explains how to install Certbot and use it on Windows.

## Supported features

All usual operations to create and manage an account, manage existing certificates, or select the ACME server, are supported.

In terms of authenticator plugins, `standalone`, `manual` and `webroot` are supported. DNS plugins will be available soon.

For now, no installer plugins are available. `apache`, `nginx` will be available soon, and a new installer for IIS is under development.

Certificate automated renewals are supported.

All options available for a given supported command will work as described by the documentation in Certbot for Windows.

## Installation

The following operations needs to be executed using an account with **administrative privileges** on the machine you want to install Certbot.

Certbot can be installed through an installer that is available:
- on GitHub: go to the Certbot GitHub release (https://github.com/certbot/certbot/releases), select the last version of Certbot (v0.40.0 currently), and download the installer named `certbot-beta-installer-win32.exe in the assets.
- on Certbot official website: _[specific URL and procedure to be defined]_

The Certbot development team ensures the authenticity of the Windows installer only for these two sources.

Once downloaded, double-click on the installer to run it. You will need to select the location for Certbot installation directory, or keep the default one (`C:\Program Files(x86)\Certbot).

At this point Certbot is ready to run.

## Using Certbot

Certbot is a command line interface with no UI. To interact with it you will need a command line: the classic one (`cmd.exe`) and Powershell aor both supported. You can also use Bash for Windows (available if you installed GIT for Windows for instance) if you prefer.

The command line needs to be executed under **administrative privileges**. Otherwise Certbot will fail to run.

Once the command line is opened, simply write the following command to get the Certbot help:
```
certbot --help
```

Indeed the Certbot installer set up the `PATH` to expose the command line interface `certbot`. So you can run it from any folder, or even include it in your scripts.

In respect with the supported features as described in the _Supported features_ section, you can check the inline help or https://certbot.eff.org/docs/ to check how to use a specific feature in Certbot.

## Configuration

Certbot works essentially with a configuration folder, where all the configuration files and generated certificates are available.

On Windows, this folder is `C:\Certbot`. This can be changed using the `--config-dir` flag on the Certbot CLI.

Within this folder you will find the following folders:
* `C:\Certbot\live`: contains current versions of issued certificates and keys
* `C:\Certbot\archive`: contains all current and previous versions of issued certificates and keys
* `C:\Certificate\logs`: contains Certbot activity logs

Doing backups of `C:\Certbot` folder is everything required to save your Certbot installation.

## Certificates renewals

Renewals are supported by Certbot for Windows and are even already configured. Indeed the Certbot installer created a scheduled task during the installation to execute `certbot renew` twice a day.

All certificates created with Certbot for Windows are then automatically renewed out-of-the-box, providing that required environment to renew is available (eg. credentials, running web server ...).

## A note on manual hooks

As explained by the [manual plugin documentation](https://certbot.eff.org/docs/using.html#manual), you may need to setup authentication and cleanup hooks to make the `manual` plugin work as expected, in particular with `DNS-01` challenges.

Similarly to Linux, Certbot for Windows supports any file executable for this platform, if it is available in the `PATH`. It can be `.bat`, `.ps` or even executable binaries like `.exe`.

## A note on files security

Assets generated by Certbot, in particular keys, are critical in term of security and should never been exposed to unauthorized accesses. Certbot for Windows leverages DACLs implemented by the NTFS filesystem to enforce this control: keys and sensible materials are readable by default only by the account that runs Certbot, the `Administrators` group and `SYSTEM`.

## Updating Certbot

When a new version of Certbot release is available, please download the new installer for this new version as described in the _Installation_ section, and run it. The installer will update you existing installation of Certbot.

## Getting help, report issues, ask for new features

If you encounter some difficulties to install or use Certbot for Windows, there is a dedicated area in LetsEncrypt support forum that can be reached at _[URL to dedicated category on Certbot (beta) for Windows in the LetsEncrypt Support Forum to be defined]_.

If you find an issue, or want to ask a new feature on Certbot for Windows, do not hesitate to create a new issue in the [Certbot GitHub repository](https://github.com/certbot/certbot/issues). Please do not forget that some existing features for Linux systems are not yet available on Windows, but are planned to be added (see the section _Supported features_).